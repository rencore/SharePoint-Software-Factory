    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
	  <html xmlns="http://www.w3.org/1999/xhtml">
	    <head>
		    <link rel="stylesheet" type="text/css" href="Styles/branding.css"/>				
		    		<title>Add Class Resource Files</title>
				<meta name="Description" content="This recipe allows to add a file which should be deployed as class resource file for an assembly." />
		<style type="text/css">

		.OH_TocResize
		{	
			top: 126px;
		}

		</style>
	</head>	
	<body class="primary-mtps-offline-document" 
	 style="max-width: 1220px;" >		<table class="noSpace" style="width: 100%;"> 
			<tr>
			  <td colspan="2" style="background-color: #6685A2;">&nbsp;</td>
			</tr>
			<tr>
			  <td>
				<img src="./_img/header_left.jpg" height="66" style="margin-top: 10px; margin-bottom: 20px" />
			  </td>
			  <td align="right" valign="top" rowspan="2">
				<img src="./_img/header_right.jpg" style="margin-top: 2px" height="72"/>
			  </td>
			</tr>			
		</table>
		<div class="OH_outerDiv">
			<div style="WIDTH: 350px" id="LeftNav" class="OH_leftNav">
				<div id="toc">
					<div id="toc_parent">
						<div class="OH_parentTocLinks">		
							<div class="OH_link">				
								<a title="SharePoint Software Factory" href="SPSF_ROOT.html">SharePoint Software Factory</a>
							</div>
									
							<div class="OH_link">				
								<a title="Recipe Index" href="SPSF_RECIPES_INDEX.html">Recipe Index</a>
							</div>
									
							<div class="OH_link">				
								<a title="SPSF Artefacts" href="SPSF_RECIPES_CATEGORY_ARTEFACTS.html">SPSF Artefacts</a>
							</div>
									
							<div class="OH_link">				
								<a title="Files" href="SPSF_RECIPES_CATEGORY_FILES.html">Files</a>
							</div>
							</div></div>					
						<div id="toc_children">
							<div class="OH_selfTocLinks">										<div class="OH_link">	
											<a title="Add Global Resource file (.resx)" href="SPSF_RECIPE_GLOBALRESXFILE.html">Add Global Resource file (.resx)</a>
										</div>

										<div title="Add Class Resource Files" class="OH_selectedChild">Add Class Resource Files</div>										<div class="OH_link">	
											<a title="Add Application Resource Files" href="SPSF_RECIPE_APPLICATIONRESOURCEFILE.html">Add Application Resource Files</a>
										</div>

																				<div class="OH_link">	
											<a title="Add Image" href="SPSF_RECIPE_IMAGEFILE.html">Add Image</a>
										</div>

																				<div class="OH_link">	
											<a title="Add Layouts file" href="SPSF_RECIPE_LAYOUTSFILE.html">Add Layouts file</a>
										</div>

										</div></div><div id="toc_siblings"><div class="OH_siblingTocHeader">Related Links</DIV><div class="OH_siblingTocLinks">							<br /></div></div></div></div><div style="LEFT: 279px" id="TocResize" class="OH_TocResize"></div>
				<div class="OH_outerContent">
				  
		<div class="OH_topic">		 
     
		  <div id="mainHeader">
			<table>
			  <tbody>
				<tr>
				  <td>
					<h1>Add Class Resource Files</h1>
				  </td>
				</tr>
			  </tbody>
			</table>
		  </div>
		</div>
		<div id="mainSection">
			<div id="mainBody">            
				<div class="introduction"><p>This recipe allows to add a file which should be deployed as class resource file for an assembly.</p></div>
				                      <DIV class="OH_CollapsibleAreaRegion">
					        <DIV class="OH_regiontitle">Recipe Description</DIV>
					        <DIV class="OH_RegionToggle"></DIV>
				        </DIV>
				        <DIV class="OH_clear"></DIV>
				        <p>
                        Class resource files are added to the project in folder 80/BIN/wpresources/[NameOfAssembly]. In manifest.xml these files are deployed to <br />        <br />        &lt;Solution xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" SolutionId="00000000-0000-0000-0000-000000000000" ResetWebServer="True" xmlns="http://schemas.microsoft.com/sharepoint/"&gt;<br />        &#160;&lt;Assemblies&gt;<br />        &#160;&#160;&lt;Assembly Location="WebPartResources.dll" DeploymentTarget="GlobalAssemblyCache"&gt;<br />        &#160;&#160;&#160;&lt;SafeControls&gt;<br />        &#160;&#160;&#160;&#160;&lt;SafeControl Assembly="WebPartResources, Version=1.0.0.0, Culture=neutral, PublicKeyToken=6763c0814d065309" Namespace="WebPartResources" TypeName="*" Safe="True" /&gt;<br />        &#160;&#160;&#160;&lt;/SafeControls&gt;<br />        &#160;&#160;&#160;&lt;ClassResources&gt;<br />        &#160;&#160;&#160;&#160;<b>&lt;ClassResource Location="testfile.gif" FileName="testfile.gif" /&gt;</b><br />        &#160;&#160;&#160;&lt;/ClassResources&gt;<br />        &#160;&#160;&lt;/Assembly&gt;<br />        &#160;&lt;/Assemblies&gt;<br />        &lt;/Solution&gt;<br />        <br />        After deployment these files are located here.<br />        For assemblies in GAX: C:\Program Files\Common Files\Microsoft Shared\web server extensions\wpresources\WebPartResources\1.0.0.0__6763c0814d065309\testfile.gif<br />        For assemblies in BIN: C:\inetpub\wwwroot\wss\VirtualDirectories\80\wpresources\1.0.0.0__6763c0814d065309\testfile.gif<br />        <br />        In code you can access there files:<br />        <br />        SPWeb currentWeb = SPControl.GetContextWeb(Context);<br />        Type currentType = this.GetType();<br />        string classResourcePath = SPWebPartManager.GetClassResourcePath(currentWeb, currentType);&#160;&#160; <br />        image = new Image();<br />        image.ImageUrl = classResourcePath + "/testfile.gif";<br />        <br />        The file could also be access via URL:<br />        <br />        http://servername/_wpresources/[assemblyname]/testfile.gif<br />        
				        </p>
				                   
                           <DIV class="OH_CollapsibleAreaRegion">
					<DIV class="OH_regiontitle">Arguments</DIV>
					<DIV class="OH_RegionToggle"></DIV>
				</DIV>
				<DIV class="OH_clear"></DIV>
				<p>
				<div class="tableSection">
                <table id="argumentTable" width="100%">
                    <tr>
                        <th>Name</th>
                        <th>Description</th>
                    </tr>							<tr>
								<td>Source Files</td>
								<td></td>
							</tr>                
							                </table>
				</div>
				</p>
                           <DIV class="OH_CollapsibleAreaRegion">
				<DIV class="OH_regiontitle">Authors</DIV>
				<DIV class="OH_RegionToggle"></DIV>
			</DIV>
			<DIV class="OH_clear"></DIV>  
			<p>
           <ul>
           <li>Torsten Mandelkow</li>           </ul>
           </p>
           
		   <DIV class="OH_CollapsibleAreaRegion">
				<DIV class="OH_regiontitle">Version history</DIV>
				<DIV class="OH_RegionToggle"></DIV>
			</DIV>
			<DIV class="OH_clear"></DIV>  
		   <p>
           <ul>
           <li>1.0 Initial Recipe</li>           </ul>
		   </p>



     
				</div>			
			</div>
		</div>
	</div>
			<br />
		<table width="100%">
		<tr>
			<td>
				<div class="OH_feedbacklink">
						<b>Disclaimer:</b> The views and opinions expressed in this documentation and in SPSF are those of the <a href="SPSF_OVERVIEW_110_AUTHORS.html">authors</a> and do not necessarily reflect the opinions and recommendations of Microsoft or any member of Microsoft. All trademarks, service marks, collective marks, copyrights, registered names, and marks used or cited by this documentation are the property of their respective owners.<br />
						SharePoint Software Factory, Version 4.1.3.2705, <a href="SPSF_OVERVIEW_800_LICENSE.html">GPLv2</a>, see <a href="http://spsf.codeplex.com">http://spsf.codeplex.com</a> for more information
				</div>
				<br />
			</td>
		</tr>
		</table>
		<br />
			</body>
</html>


